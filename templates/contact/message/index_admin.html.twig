{% extends 'base.html.twig' %}

{% block title %}Liste des messages{% endblock %}

{% block body %}

	<div class="container">
		<div class='row mb-3'>

			{# TITRE #}
			<h2 class="radius-long offset-4 col-4">Liste des messages</h2>

			{# TABLEAU LISTE #}
			<section class='col-12 mb-3'>
				<table class="table">
					<thead>
						<tr class="left">
							<th width="4%">Voir</th>
							<th width="4%">id</th>
							<th width="13%">Destinateur</th>
							<th width="13%">Destinataire</th>
							<th width="18%">Libellé</th>
							<th width="30%">Contenu</th>
							<th width="10%" class="center">Date</th>
							<th width="8%" class="center">Actions</th>
						</tr>
					</thead>
					<tbody>
					{% for m in messages %}
						<tr class="{{ m.lu != true ? 'gras' }}">
							<td>
								<a href="{{ path('message_show', {'id': m.id}) }}">
									<i class="fa{{ m.lu ? 'r' }} fa-comment" title="{{ m.lu ? 'Voir le message' : 'Voir les réponses' }}"></i>
								</a>
							</td>
							<td>{{ m.id }}</td>
							<td>
								<a href="{{ path('user_show', {'id': m.user.id}) }}">
									{{
										m.user.prenom != null and m.user.nom != null
											? m.user.prenom|capitalize ~ ' ' ~ m.user.nom|upper
											: m.user.userName|capitalize
									}}
								</a>
							</td>
							<td>
								{{
									m.destinataire != null
										? m.destinataire.prenom != null and m.destinataire.nom != null
											? m.destinataire.prenom|capitalize ~ ' ' ~ m.destinataire.nom|upper
											: m.destinataire.userName|capitalize
										: 'Admin'
								}}
							</td>
							<td>{{ m.libelle }}</td>
							<td>{{ m.description }}</td>
							<td class="center">{{ m.date|date('d/m/Y') }}</td>
							<td style='min-width:100px;'>
								<div class='row'>
									<div class='offset-2 col-5 p-0' style="max-height: 30px">
										<button class="btn pt-0">
											<a href="{{ path('message_edit', {'id': m.id}) }}">
												<i class="fas fa-edit" title="Modifier le message"></i>
											</a>
										</button>
									</div>
									<div class='col-5 p-0' style="max-height: 30px">
										{% include('contact/message/_delete_form.html.twig') with {'message': m, 'btn': false} %}
									</div>
								</div>
							</td>
						</tr>
					{% else %}
						<tr>
							<td colspan="11">Pas de message</td>
						</tr>
					{% endfor %}
					</tbody>
				</table>
			</section>
		</div>
	</div>
{% endblock %}
